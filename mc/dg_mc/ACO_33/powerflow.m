function [DS,V] = powerflow(OP)
    %bus_temp(:,[4,5])= bus_temp(:,[4,5])*1.6;
% OP = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0];
% OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1];
%% ¶Ï¿ª7¡¢9¡¢14¡¢37¡¢32
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0];
%% ¶Ï¿ª7¡¢9¡¢14¡¢28¡¢32
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1];
%% ¶Ï¿ª7¡¢9¡¢14¡¢37¡¢32
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0];
%% ¶Ï¿ª7¡¢9¡¢14¡¢28¡¢36
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1];
%% 7\9\14\37\36
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0];
%% 7\10\14\28\32
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1];
%% 7\10\14\37\32
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0];
%% 7\10\14\28\36
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1];
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0];
%OP = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0];
%OP = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0];
%% 33\11\34\36\37
%OP = [1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,0];
%% 33 11 34 28 32
%OP = [1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,0,1,1,1];
%% 7 11 34 28 32
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,0,1,1,1];
%%
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,0,1,1,1];
%% 7 10 14 37 36
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0];
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0];
%% 7 11 14 28 32
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1];
%% 7 11 14 37 36
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0];

%% 7 11 14 37 32
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0];
%% 7 10 34 37 36
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0];
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1];
%% ¸ººÉË®Æ½Îª1.6 ¶Ï¿ª¿ª¹ØÎª2¡¢9¡¢14¡¢27¡¢36
%*********************************************************************
%OP = [1,1,1,1,1,1,0,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0];

%% 33 9 34 37 36
%OP = [1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,0];
%% 7 9 14 37 32
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0];
%% 7 9 14 28 32
%OP = [1,1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1];
%% 7 14 11 32 27
%OP = [1,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1];
%OP = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0];
%%

[bus branch] = testof33();
bus_temp = bus;
branch_temp = branch;

% ii = 1;
for i = 1:37
    % if OP(i) == 1
    if OP(i) == 0
        % branch_new(ii,:) = branch_temp(i,:);
        branch_temp(i , 3) = 10000;
        % ii = ii+1;
    end
end
% branch_temp = branch_new;

% statusMC(branch_temp);
%% ½ÚµãÖØÐÂ±àºÅ
%½ÚµãµÄË³Ðò£ºÆ½ºâ½Úµã¡¢PQ½Úµã¡¢PV½Úµã
[bus_temp,branch_temp,nodenum] = reordering(bus_temp,branch_temp);

%% ÐÎ³É½Úµãµ¼ÄÉ¾ØÕó
Ybus = admittance_matrix(bus_temp,branch_temp);
NRloop;
% DS
V_min = V(3);
V_max = V(3);
for i = 3:35
    if V(i)<V_min
        V_min = V(i);
    end
    if V(i)>V_max
        V_max = V(i);
    end
end
V_min;
V_max;

end

