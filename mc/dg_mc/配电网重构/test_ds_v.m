global bus branch
testof33();

hf = [
    % 33 11 14 26 29;
    % 19 10 12 37 15;
    % 5 21 14 26 30;
    % 19 10 34 26 32;
    % 5 35 34 25 31;
% ===================
    33 34 35 36 37;
    6 33 12 26 36;
    3 11 13 27 16;
    33 11 13 25 16;
    4 8 14 27 32;
    33 10 13 25 32;
    6 9 14 28 31;
    7 11 13 27 32;
    33 10 34 27 36;
    7 10 14 37 17;
    33 10 34 28 36;
    7 9 14 37 32
    ];
ds = [
    % 244.37;
    % 237.99;
    % 228.13;
     % 221.17;
    % 212.00;
% ================
    202.67;
    192.70;
    189.48;
    175.40;
    169.55;
    163.19;
    156.93;
    149.97;
    148.98;
    147.76
    145.92;
    139.55
];
v = [];
for i = 1 : length(hf(:, 1))
    op = ones(1, 37);
    for j = 1 : length(hf(i, :))
        op(hf(i, j)) = 0;
    end
    [a b ] = powerflow( bus, op);
    temp = b;
    v = [v  min(temp(3:end))]
end
v = v';
stem(ds, v);
ylim([0.9,0.95])